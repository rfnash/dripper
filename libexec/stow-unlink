#!/usr/bin/env bash

source stow-requirements
source stow-base

set_options $*

# stow unlink --all
if [ -n "$all" ]; then
  for stow in $STOW_PATH/*; do
    current_stow=${stow##*/}
    if [ ! $current_stow = 'stow-1.3.3' ]; then
      $STOW_BINARY -v -D -d $STOW_PATH $current_stow
    else
      special_definition='stow-1.3.3'
    fi
  done

  if [ -n "$special_definition" ]; then
    $STOW_BINARY -v -D -d $STOW_PATH $special_definition
  fi
  exit
fi

# stow unlink <package>
source stow-validator
source $STOW_DEFINITIONS_PATH/$1
stow_unlink
